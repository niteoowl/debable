<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>토론 개설 | Debable</title>
    <link rel="stylesheet" as="style" crossorigin
        href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.8/dist/web/static/pretendard.css" />
    <link rel="stylesheet" href="css/reset.css">
    <link rel="stylesheet" href="css/style.css">
</head>

<body>

    <div id="app-header-target"></div>

    <div class="app-container">

        <div id="left-sidebar-target"></div>

        <main class="main-feed">
            <!-- Progress Steps -->
            <div class="create-steps">
                <div class="create-step active" data-step="1">1. 주제 설정</div>
                <div class="create-step" data-step="2">2. 규칙 설정</div>
                <div class="create-step" data-step="3">3. 완료</div>
            </div>

            <!-- Step 1: Topic -->
            <div id="step-1" class="step-content">
                <div class="form-section">
                    <label class="form-label">토론 주제 <span style="color: #EF4444">*</span></label>
                    <input type="text" id="topic-input" class="form-input" placeholder="논쟁하고 싶은 주제를 명확하게 입력해주세요.">
                    <p class="form-helper">예: 촉법소년 연령 하향, 필요한가?</p>
                </div>

                <div class="form-section">
                    <label class="form-label">카테고리 <span style="color: #EF4444">*</span></label>
                    <div class="option-grid" id="category-grid">
                        <div class="option-card" data-value="정치/사회">
                            <div class="option-title">🏛️ 정치/사회</div>
                        </div>
                        <div class="option-card" data-value="IT/기술">
                            <div class="option-title">💻 IT/기술</div>
                        </div>
                        <div class="option-card" data-value="경제">
                            <div class="option-title">💰 경제</div>
                        </div>
                        <div class="option-card" data-value="문화/연예">
                            <div class="option-title">🎬 문화/연예</div>
                        </div>
                        <div class="option-card" data-value="라이프">
                            <div class="option-title">☕ 라이프</div>
                        </div>
                        <div class="option-card" data-value="스포츠">
                            <div class="option-title">⚽ 스포츠</div>
                        </div>
                    </div>
                </div>

                <div class="form-section">
                    <label class="form-label">상세 배경 (선택)</label>
                    <textarea id="background-input" class="form-textarea" rows="4"
                        placeholder="토론의 배경이나 주요 쟁점을 설명해주세요. 링크나 자료를 첨부하면 더 좋습니다."></textarea>
                </div>

                <button class="btn-primary" onclick="goToStep(2)" id="next-btn-1" disabled>다음 단계로</button>
            </div>

            <!-- Step 2: Rules -->
            <div id="step-2" class="step-content" style="display: none;">
                <div class="form-section">
                    <label class="form-label">토론 형식 <span style="color: #EF4444">*</span></label>
                    <div class="option-grid" id="format-grid">
                        <div class="option-card selected" data-value="1:1">
                            <div class="option-title">1 : 1</div>
                            <div class="option-desc">맞짱 토론</div>
                        </div>
                        <div class="option-card" data-value="3:3">
                            <div class="option-title">3 : 3</div>
                            <div class="option-desc">팀 토론</div>
                        </div>
                        <div class="option-card" data-value="자유">
                            <div class="option-title">자유</div>
                            <div class="option-desc">인원 제한 없음</div>
                        </div>
                    </div>
                </div>

                <div class="form-section">
                    <label class="form-label">라운드 수</label>
                    <div class="option-grid" id="round-grid">
                        <div class="option-card" data-value="2">
                            <div class="option-title">2 라운드</div>
                            <div class="option-desc">약 20분</div>
                        </div>
                        <div class="option-card selected" data-value="3">
                            <div class="option-title">3 라운드</div>
                            <div class="option-desc">약 30분</div>
                        </div>
                        <div class="option-card" data-value="5">
                            <div class="option-title">5 라운드</div>
                            <div class="option-desc">약 50분</div>
                        </div>
                    </div>
                </div>

                <div class="form-section">
                    <label class="form-label">발언 시간 (분)</label>
                    <select class="form-select" id="time-select">
                        <option value="3">3분</option>
                        <option value="5" selected>5분</option>
                        <option value="7">7분</option>
                        <option value="10">10분</option>
                    </select>
                </div>

                <div class="form-section">
                    <label class="form-label">내 입장 <span style="color: #EF4444">*</span></label>
                    <div class="option-grid" style="grid-template-columns: 1fr 1fr;" id="stance-grid">
                        <div class="option-card selected" data-value="찬성" style="border-color: #2563EB;">
                            <div class="option-title" style="color: #2563EB;">👍 찬성</div>
                            <div class="option-desc">이 주제에 찬성합니다</div>
                        </div>
                        <div class="option-card" data-value="반대">
                            <div class="option-title" style="color: #DC2626;">👎 반대</div>
                            <div class="option-desc">이 주제에 반대합니다</div>
                        </div>
                    </div>
                </div>

                <div style="display: flex; gap: 12px;">
                    <button class="btn-primary" style="background: var(--bg-surface); color: var(--text-sub);"
                        onclick="goToStep(1)">이전</button>
                    <button class="btn-primary" onclick="goToStep(3)">토론 개설하기</button>
                </div>
            </div>

            <!-- Step 3: Complete -->
            <div id="step-3" class="step-content" style="display: none;">
                <div style="text-align: center; padding: 60px 20px;">
                    <div style="font-size: 64px; margin-bottom: 24px;">🎉</div>
                    <h2 style="font-size: 24px; font-weight: 800; margin-bottom: 12px;">토론이 개설되었습니다!</h2>
                    <p style="color: var(--text-sub); margin-bottom: 32px; line-height: 1.6;">
                        상대 패널이 참가하면 알림을 보내드릴게요.<br>
                        지금 바로 토론 내용을 공유해보세요.
                    </p>

                    <div
                        style="background: var(--bg-surface); border-radius: 12px; padding: 20px; margin-bottom: 24px; text-align: left;">
                        <div style="font-size: 12px; color: var(--text-light); margin-bottom: 8px;">개설된 토론</div>
                        <div style="font-size: 18px; font-weight: 700;" id="created-topic">-</div>
                        <div style="font-size: 14px; color: var(--text-sub); margin-top: 8px;">
                            <span id="created-format">1:1</span> • <span id="created-rounds">3라운드</span> • <span
                                id="created-stance">찬성</span>
                        </div>
                    </div>

                    <div style="display: flex; gap: 12px;">
                        <button class="btn-primary" style="background: var(--bg-surface); color: var(--text-sub);"
                            onclick="MapsTo('index.html')">홈으로</button>
                        <button class="btn-primary" onclick="shareDebate()">🔗 공유하기</button>
                    </div>
                </div>
            </div>

        </main>

        <aside class="right-sidebar">
            <section class="widget">
                <h3 class="widget-title">💡 개설 가이드</h3>
                <div class="widget-item" style="cursor: default;">
                    <div class="widget-rank">1</div>
                    <div class="widget-text" style="white-space: normal;">주제는 구체적일수록 좋습니다. "AI"보다는 "수업 중 AI 사용 금지"가
                        좋습니다.</div>
                </div>
                <div class="widget-item" style="cursor: default;">
                    <div class="widget-rank">2</div>
                    <div class="widget-text" style="white-space: normal;">배경 설명에 관련 기사나 데이터를 첨부하면 더 활발한 토론이 됩니다.</div>
                </div>
                <div class="widget-item" style="cursor: default;">
                    <div class="widget-rank">3</div>
                    <div class="widget-text" style="white-space: normal;">첫 토론이라면 3라운드, 5분 발언을 추천드려요.</div>
                </div>
            </section>

            <section class="widget">
                <h3 class="widget-title">📊 이번 주 인기 주제</h3>
                <div class="widget-item" style="cursor: default;">
                    <div class="widget-text" style="white-space: normal;">1. AI 저작권 인정 여부</div>
                </div>
                <div class="widget-item" style="cursor: default;">
                    <div class="widget-text" style="white-space: normal;">2. 반려동물 보험 의무화</div>
                </div>
                <div class="widget-item" style="cursor: default;">
                    <div class="widget-text" style="white-space: normal;">3. 주 4일제 도입</div>
                </div>
            </section>
        </aside>

    </div>

    <div id="mobile-nav-target"></div>

    <script src="js/layout.js"></script>
    <script>
        // Form state
        let formData = {
            topic: '',
            category: '',
            background: '',
            format: '1:1',
            rounds: '3',
            time: '5',
            stance: '찬성'
        };

        // Option grid selection logic
        function setupOptionGrid(gridId, key) {
            const grid = document.getElementById(gridId);
            if (!grid) return;

            grid.querySelectorAll('.option-card').forEach(card => {
                card.addEventListener('click', function () {
                    grid.querySelectorAll('.option-card').forEach(c => c.classList.remove('selected'));
                    this.classList.add('selected');
                    formData[key] = this.dataset.value;
                    validateStep1();
                });
            });
        }

        // Validate step 1
        function validateStep1() {
            const topic = document.getElementById('topic-input').value.trim();
            const category = formData.category;
            const btn = document.getElementById('next-btn-1');

            if (topic.length >= 5 && category) {
                btn.disabled = false;
            } else {
                btn.disabled = true;
            }

            formData.topic = topic;
        }

        // Go to step
        function goToStep(step) {
            // Validate before moving
            if (step === 2) {
                formData.background = document.getElementById('background-input').value;
            }

            if (step === 3) {
                formData.time = document.getElementById('time-select').value;
                // Show completion
                document.getElementById('created-topic').textContent = formData.topic;
                document.getElementById('created-format').textContent = formData.format;
                document.getElementById('created-rounds').textContent = formData.rounds + '라운드';
                document.getElementById('created-stance').textContent = formData.stance;
            }

            // Hide all steps
            document.querySelectorAll('.step-content').forEach(el => el.style.display = 'none');

            // Show current step
            document.getElementById('step-' + step).style.display = 'block';

            // Update step indicators
            document.querySelectorAll('.create-step').forEach(el => {
                const s = parseInt(el.dataset.step);
                el.classList.remove('active', 'completed');
                if (s < step) el.classList.add('completed');
                if (s === step) el.classList.add('active');
            });

            window.scrollTo(0, 0);
        }

        // Share debate
        function shareDebate() {
            if (navigator.share) {
                navigator.share({
                    title: formData.topic + ' - Debable',
                    text: '토론에 참여해주세요!',
                    url: window.location.origin + '/view.html'
                });
            } else {
                navigator.clipboard.writeText(window.location.origin + '/view.html');
                alert('링크가 복사되었습니다!');
            }
        }

        // Initialize on load
        document.addEventListener('DOMContentLoaded', () => {
            setupOptionGrid('category-grid', 'category');
            setupOptionGrid('format-grid', 'format');
            setupOptionGrid('round-grid', 'rounds');
            setupOptionGrid('stance-grid', 'stance');

            document.getElementById('topic-input').addEventListener('input', validateStep1);
        });
    </script>
</body>

</html>